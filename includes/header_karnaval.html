<!-- Facebook Pixel Code -->
<script>
	!function(f,b,e,v,n,t,s)
	{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
			n.callMethod.apply(n,arguments):n.queue.push(arguments)};
		if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
		n.queue=[];t=b.createElement(e);t.async=!0;
		t.src=v;s=b.getElementsByTagName(e)[0];
		s.parentNode.insertBefore(t,s)}(window,document,'script',
			'https://connect.facebook.net/en_US/fbevents.js');
	fbq('init', '2900742666616942');
	fbq('track', 'PageView');
</script>
<noscript>
	<img height="1" width="1"
		 src="https://www.facebook.com/tr?id=2900742666616942&ev=PageView
&noscript=1"/>
</noscript>
<!-- End Facebook Pixel Code -->

<!--Start of Zopim Live Chat Script-->
<script type="text/javascript">
window.$zopim||(function(d,s){var z=$zopim=function(c){z._.push(c)},$=z.s=
d.createElement(s),e=d.getElementsByTagName(s)[0];z.set=function(o){z.set.
_.push(o)};z._=[];z.set._=[];$.async=!0;$.setAttribute('charset','utf-8');
$.src='//v2.zopim.com/?1fNcDaKvbuLZFXc7ZsO5PVc9ChG7jbW5';z.t=+new Date;$.
type='text/javascript';e.parentNode.insertBefore($,e)})(document,'script');
</script>
<!--End of Zopim Live Chat Script-->
<style>

.search {margin: 0 auto}


.search {
	/* устанавливаем необходимую ширину формы в зависимости от дизайна
	** форма без проблем растягивается */
	width: 202px;

	/* кнопку отправки будем позиционировать абсолютно,
	** поэтому необходимо это свойство */
	position: absolute;
	top:230px;
	left:0px;
}

.search input {
	/* отключаем бордюры у инпутов */
	border: none;
}

/* стили для поля ввода */
.search .input {
	/* растягиваем поле ввода на всю ширину формы */
	width: 100%;

	/* за счет верхнего (8px) и нижнего (9px) внутренних отступов
	** регулируем высоту формы
	** внутренний отступ справа (37px) делаем больше левого,
	** т.к. там будет размещена кнопка отправки	*/
	padding: 8px 15px 9px 37px;

	/* чтобы ширина поля ввода (100%) включала в себя внутренние отступы */
	-moz-box-sizing: border-box;
	box-sizing: border-box;

	/* добавляем внутренние тени */
	box-shadow: inset 0 0 5px rgba(0,0,0,0.1), inset 0 1px 2px rgba(0,0,0,0.3);

	/* закругляем углы */
	border-radius: 5px;

	background: #EEE;
	font: 13px Tahoma, Arial, sans-serif;
	color: #555;
	outline: none;
}

/* меняем оформление поля ввода при фокусе */
.search .input:focus {
	box-shadow: inset 0 0 5px rgba(0,0,0,0.2), inset 0 1px 2px rgba(0,0,0,0.4);
	background: #E8E8E8;
	color: #333;
}

/* оформляем кнопку отправки */
.search .submit {
	/* позиционируем кнопку абсолютно от правого края формы */
	position: absolute;
	top: 0;
	left: 0;

	width: 37px;

	/* растягиваем кнопку на всю высоту формы */
	height: 100%;

	cursor: pointer;
	background: url(https://lh4.googleusercontent.com/-b-5aBxcxarY/UAfFW9lVyjI/AAAAAAAABUg/gQtEXuPuIds/s13/go.png) 50% no-repeat;

	/* добавляем прозрачность кнопке отправки */
	opacity: 0.5;
}

/* при наведении курсора меняем прозрачность кнопки отправки */
.search .submit:hover {
	opacity: 0.8;
}

/* данное свойство необходимо для того, чтобы в браузерах
** Chrome и Safari можно было стилизовать инпуты */
input[type="search"] {
	-webkit-appearance: none;
}
</style>

<!--[if lt IE 9]>
<style>
/* задаем отдельные стили для браузеров IE ниже 9-й версии */
*+html .search {
	/* для IE7 подгоняем ширину под другие браузеры и добавляем правый
	** внутренний отступ, чтобы кнопка отправки встала на свое место */
	width: 28%;
	padding: 0 52px 0 0;
}
.search .input {
	border: 1px solid #DFDFDF;
	border-top: 1px solid #B3B3B3;
	padding-top: 7px;
	background-bottom: 8px;
}
.search .input:focus {
	border: 1px solid #CFCFCF;
	border-top: 1px solid #999;
}
.search .submit {
	filter: alpha(opacity=50);
}
.search .submit:hover {
	filter: alpha(opacity=80);
}
</style>
<![endif]-->

<!--наличие товара-->
<?php  

//карнавальный слайдер
function k_slider($m_list) {

global $mysqli;
	
$models_list='';
foreach ($m_list as $value) {
	$models_list.='\''.$value.'\', ';
}
$models_list=substr($models_list,0,strlen($models_list)-2);

//основной запрос
$k_mod_q= "SELECT * FROM rent_model_web LEFT JOIN rent_tarif_act ON (rent_model_web.model_id = rent_tarif_act.model_id) WHERE rent_model_web.model_id IN ($models_list)";
$result_k_mod = $mysqli->query($k_mod_q);
if (!$result_k_mod) {die('Сбой при доступе к базе данных: '.$k_mod_q.' ('.$mysqli->connect_errno.') '. $mysqli->connect_error);}
$k_mod_num=$result_k_mod->num_rows;


echo '

<ul id="mycarousel" class="jcarousel-skin-tango">';

while ($k_mod=$result_k_mod->fetch_assoc()) {

echo '
<li style="height:250px;width:170px;padding:0;">
<a href="'.$k_mod['page_addr'].'"><img src="'.$k_mod['l2_pic'].'" alt="'.$k_mod['l2_alt'].'" title="'.$k_mod['m_a_title'].'" /></a>
<br /><a href="'.$k_mod['page_addr'].'">'.$k_mod['item_name_main'].'<br />'.number_format($k_mod['rent_amount'], 2, ',', ' ').' руб./сутки</a>
</li>

';

}

echo '</ul>';

}//конец карнавального слайдера





//вывод на карнавалов на 2-m уровне
function k_models ($sex, $rost_from, $rost_to, $ny, $zv, $tale, $models_list='empty') {//sex - массив со значениями, если указаны модели, то на все остальные условия забиваем
	global $mysqli;

	$sex_list='';
	foreach ($sex as $value) {
		$sex_list.='\''.$value.'\', ';
	}
	$sex_list=substr($sex_list,0,strlen($sex_list)-2);

	$k_srch='';
	
	if ($ny=='1') {
		$k_srch.=" AND tovar_rent.ny='1'";
	}
	elseif ($ny=='-1') {
		$k_srch.=" AND tovar_rent.ny!='1'";
	}
	
	if ($zv=='1') {
		$k_srch.=" AND tovar_rent.zv='1'";
	}
	elseif ($zv=='-1') {
		$k_srch.=" AND tovar_rent.zv!='1'";
	}
	
	if ($tale=='1') {
		$k_srch.=" AND tovar_rent.tale='1'";
	}
	elseif ($tale=='-1') {
		$k_srch.=" AND tovar_rent.tale!='1'";
	}
	
	$used_models=array();
	
	//основной запрос
	$k_mod_q= "SELECT * FROM tovar_rent LEFT JOIN rent_model_web ON (tovar_rent.tovar_rent_id = rent_model_web.model_id) WHERE tovar_rent.m_sex IN ($sex_list) AND tovar_rent.tovar_rent_cat_id IN ('2', '61')$k_srch ORDER BY sort_n";
	if ($models_list!='empty') {//если указан перечень моделей - все остальное пофиг.
	//убираем препятствия - т.е.ищем все, просто влом писать новую функцию
		$sex=array('f', 'm', 'u');
		$rost_from=0;
		$rost_to=1000; 
		$ny=$zv=$tale=0; 
		
		$models_srch='';
		foreach ($models_list as $value) {
			$models_srch.='\''.$value.'\', ';
		}
		$models_srch=substr($models_srch,0,strlen($models_srch)-2);
		$k_mod_q= "SELECT * FROM tovar_rent LEFT JOIN rent_model_web ON (tovar_rent.tovar_rent_id = rent_model_web.model_id) WHERE tovar_rent.tovar_rent_id IN ($models_srch) AND tovar_rent.tovar_rent_cat_id IN ('2', '61') ORDER BY sort_n";	
	}
	$result_k_mod = $mysqli->query($k_mod_q);
	if (!$result_k_mod) {die('Сбой при доступе к базе данных: '.$k_mod_q.' ('.$mysqli->connect_errno.') '. $mysqli->connect_error);}
	$k_mod_num=$result_k_mod->num_rows;

	while ($k_mod=$result_k_mod->fetch_assoc()) {

		//ищем тариф
		$query_tarifs = "SELECT * FROM rent_tarif_act WHERE model_id='".$k_mod['tovar_rent_id']."' ORDER BY sort_num, kol_vo";
		$result_tarifs = $mysqli->query($query_tarifs);
		if (!$result_tarifs) {die('Сбой при доступе к базе данных: '.$query_tarifs.' ('.$mysqli->connect_errno.') '. $mysqli->connect_error);}
		$tarif_def=$result_tarifs->fetch_assoc();

		//ищем размеры
		$query_items = "SELECT * FROM tovar_rent_items WHERE model_id='".$k_mod['tovar_rent_id']."' ORDER BY item_rost1, item_rost2";
		$result_items = $mysqli->query($query_items);
		if (!$result_items) {die('Сбой при доступе к базе данных: '.$query_items.' ('.$mysqli->connect_errno.') '. $mysqli->connect_error);}
		$s_num=$result_items->num_rows;

		$k_sizes=array();
		$razm_ok='0';
		$k_i_size='';

		while ($k_item=$result_items->fetch_assoc()) {
			
			$k_i_size=$k_item['item_rost1'].'-'.$k_item['item_rost2'];
				
			if (!in_array($k_i_size, $k_sizes)) {
				$k_sizes[]=$k_i_size;
			}
			

						
			//отсечение по размеру
			if (($k_item['item_rost1']>=$rost_from AND $k_item['item_rost1']<=$rost_to) OR ($k_item['item_rost2']>=$rost_from AND $k_item['item_rost2']<=$rost_to)) {
				$razm_ok='1';
			}

		}

		//если по размеру не подошел - не выводим
		if ($razm_ok!='1') {
			continue;
		}
		
		$k_sizes_text='';
		foreach ($k_sizes as $value) {
			$k_sizes_text.=$value.',';
		}
		$k_sizes_text=substr($k_sizes_text,0,strlen($k_sizes_text)-1);//убираем последнюю запятую



	if (!in_array($k_mod['tovar_rent_id'],$used_models, true)) {
		echo '
		<a href="'.$k_mod['page_addr'].'"><div class="k_top_2">
			<div class= "k_l2_text">'.$k_mod['l2_name'].'</div>
			<div class= "k_box_img"><img src="'.$k_mod['l2_pic'].'" alt="'.$k_mod['l2_alt'].'" /></div>
			<div class="k_down_1l">Размер:</div><div class="k_down_1r"><div class="k_line">'.$k_sizes_text.'</div></div>
			<div class="k_down_1l">Тариф:</div><div class="k_down_2r"><div class="k_line">'.number_format($tarif_def['rent_amount'], 2, ',', ' ').' руб./ сутки</div></div>
			<div class="k_down_1l">On-line</div><div class="k_down_3r"><div class="k_line">БРОНИРОВАНИЕ</div></div>
		</div> </a>
			';
		$used_models[]=$k_mod['tovar_rent_id'];
		}

	}//end of while
}//end of fucntion
 

require_once ($_SERVER['DOCUMENT_ROOT'].'/bb/database_new.php'); // включаем подключение к базе данных

function model_yn($id) {
	global $mysqli;

	$free_q1 = "SELECT (item_id) FROM tovar_rent_items WHERE model_id='$id' AND `status`='to_rent' AND item_place='1' LIMIT 1";
	$result_free1 = $mysqli->query($free_q1);
	if (!$result_free1) {die('Сбой при доступе к базе данных: '.$free_q1.' ('.$mysqli->connect_errno.') '. $mysqli->connect_error);}
	$free1=$result_free1->num_rows;

	$free_q2 = "SELECT (item_id) FROM tovar_rent_items WHERE model_id='$id' AND `status`='to_rent' AND item_place='2' LIMIT 1";
	$result_free2 = $mysqli->query($free_q2);
	if (!$result_free2) {die('Сбой при доступе к базе данных: '.$free_q2.' ('.$mysqli->connect_errno.') '. $mysqli->connect_error);}
	$free2=$result_free2->num_rows;
	
	if ($free1>0 && $free2>0) {
		echo 'top_2';
	}
	elseif ($free1>0 && $free2==0) {
		echo 'top_2_1';
	}
	elseif ($free1==0 && $free2>0) {
		echo 'top_2_2';
	}
	else {
		echo 'top_3';
	}
}


function model_yn2($cat_id, $color) {
	global $mysqli;

	$free_q1 = "SELECT (item_id) FROM tovar_rent_items WHERE cat_id='$cat_id' AND `status`='to_rent' AND item_color='$color' AND item_place='1' LIMIT 1";
	$result_free1 = $mysqli->query($free_q1);
	if (!$result_free1) {die('Сбой при доступе к базе данных: '.$free_q1.' ('.$mysqli->connect_errno.') '. $mysqli->connect_error);}
	$free1=$result_free1->num_rows;

	$free_q2 = "SELECT (item_id) FROM tovar_rent_items WHERE cat_id='$cat_id' AND `status`='to_rent' AND item_color='$color' AND item_place='2' LIMIT 1";
	$result_free2 = $mysqli->query($free_q2);
	if (!$result_free2) {die('Сбой при доступе к базе данных: '.$free_q2.' ('.$mysqli->connect_errno.') '. $mysqli->connect_error);}
	$free2=$result_free2->num_rows;

	if ($free1>0 && $free2>0) {
		echo 'top_2';
	}
	elseif ($free1>0 && $free2==0) {
		echo 'top_2_1';
	}
	elseif ($free1==0 && $free2>0) {
		echo 'top_2_2';
	}
	else {
		echo 'top_3';
	}
}




function model_yn3 ($model_id, $color) {
	global $mysqli;

	$free_q1 = "SELECT (item_id) FROM tovar_rent_items WHERE model_id='$model_id' AND `status`='to_rent' AND item_color='$color' AND item_place='1' LIMIT 1";
	$result_free1 = $mysqli->query($free_q1);
	if (!$result_free1) {die('Сбой при доступе к базе данных: '.$free_q1.' ('.$mysqli->connect_errno.') '. $mysqli->connect_error);}
	$free1=$result_free1->num_rows;

	$free_q2 = "SELECT (item_id) FROM tovar_rent_items WHERE model_id='$model_id' AND `status`='to_rent' AND item_color='$color' AND item_place='2' LIMIT 1";
	$result_free2 = $mysqli->query($free_q2);
	if (!$result_free2) {die('Сбой при доступе к базе данных: '.$free_q2.' ('.$mysqli->connect_errno.') '. $mysqli->connect_error);}
	$free2=$result_free2->num_rows;

	if ($free1>0 && $free2>0) {
		echo 'top_2';
	}
	elseif ($free1>0 && $free2==0) {
		echo 'top_2_1';
	}
	elseif ($free1==0 && $free2>0) {
		echo 'top_2_2';
	}
	else {
		echo 'top_3';
	}
}


?>







<!--Zvonki Script-->
<script type="text/javascript">

function getXmlHttp(){
	  var xmlhttp;
	  try {
	    xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
	  } catch (e) {
	    try {
	      xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
	    } catch (E) {
	      xmlhttp = false;
	    }
	  }
	  if (!xmlhttp && typeof XMLHttpRequest!='undefined') {
	    xmlhttp = new XMLHttpRequest();
	  }
	  return xmlhttp;
	}





function zv_show () {
	
	document.getElementById('zv_place').innerHTML='<img src="/includes/loading.gif" />';
	
	var q_type="zakaz_zv";

	var xmlhttp = getXmlHttp()
	xmlhttp.open("POST", '/includes/zvonok.php', true)
	xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
	
		var params = 'q_type=' + encodeURIComponent(q_type);

	xmlhttp.send(params);
	xmlhttp.onreadystatechange = function() {
	  if (xmlhttp.readyState == 4) {
	     if(xmlhttp.status == 200) {
		    document.getElementById('zv_place').innerHTML=xmlhttp.responseText;
			document.getElementById('gr_fone').style.display="block";
	           }
	  		}
		}
}


function cans_zv () {
	document.getElementById('zv_place').innerHTML='';
	document.getElementById('gr_fone').style.display="none";
}


function zv_send () {
	valid = true;

	kk_name = kk_phone = "";

	// проверка клиента
	if (document.getElementById('z_name').value=="")
	{kk_name="Имя, ";
     valid = false;}

	if (document.getElementById('phone').value=="")
	{kk_phone="Телефон, ";
     valid = false;}
		 
	if (valid==false){
	alert ('Заполните все поля формы! В частности: ' + kk_name + kk_phone);
		}

if (valid==true) {	 
	 
	var q_type='zv_send';
	
//gether values for base / letter
	var z_name=document.getElementById('z_name').value;
	var phone=document.getElementById('phone').value;
	var operator=document.getElementById('operator').value;
	var tema=document.getElementById('tema').value;
	var info=document.getElementById('info').value;

	var xmlhttp = getXmlHttp()
	xmlhttp.open("POST", '/includes/zvonok.php', true)
	xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');

	var params = 'z_name=' + encodeURIComponent(z_name) + '&phone=' + encodeURIComponent(phone) + '&operator=' + encodeURIComponent(operator) + '&tema=' + encodeURIComponent(tema) + '&info=' + encodeURIComponent(info) + '&q_type=' + encodeURIComponent(q_type);

	document.getElementById('zv_place').innerHTML='<img src="/includes/loading.gif" />';

	xmlhttp.send(params);
	xmlhttp.onreadystatechange = function() {
	  if (xmlhttp.readyState == 4) {
	     if(xmlhttp.status == 200) {
		
		    document.getElementById('zv_place').innerHTML=xmlhttp.responseText;
	           }
	  		}
		}


}//end of valid if
}//end of zv_send function

</script>
<!--End of Zvonki Script-->


<div id="header">


<a href="/"><div style="float:left; margin-top: 10px; margin-left: 0px; width: 200px; height: 80px;"><img src="/images/logo.png"></div></a>
<div id="header_main">прокат детских товаров</div>

<div class="header_text">КАРНАВАЛЬНЫЕ КОСТЮМЫ ДЛЯ ДЕТЕЙ</div>
	<a href="/about/o_nas_k.htm" class="header_slogan"><img src="/includes/point.jpg" style="position:absolute; top:-7px; left:-34px;" /><span class="slogan_addr">Адрес салона: Минск</span>ул. Литературная 22
	</a>
	<div class="header_k_time"><img src="/includes/time.jpg" style="position:absolute; top:-6px; left:-37px;" /><span class="slogan_addr">
	Время работы:</span>10:00 - 19:00 *<span class="slogan_minsk" style="color:red; position:absolute; top: 25px;">Сб: 10:00-16:00<br>Вс: 10:00-16:00</span></div>
	<a href="tel:6944040" class="header_k_tel2"><img src="/includes/phone.jpg" style="position:absolute; top:-6px; left:-37px;" /><span class="slogan_addr">Все операторы</span>694 40 40<span class="slogan_minsk" style="width:100px; text-align:left; color:red">Velcom  MTC  Life</span></a>


<div class="navi_k1">
  <ul>
    <li class="sm1"><a href="/karnaval/karnaval.htm"></a></li>
    <li class="sm2"><a href="/karnaval/terms_karnaval.htm"></a></li>
    <li class="sm3"><a href="/karnaval/bronirovanie_karnaval.htm"></a></li>
    <li class="sm4"><a href="/about/bron_primerka.htm"></a></li>
    <li class="sm5"><a href="/about/bron_otkaz.htm"></a></li>
    <li class="sm6"><a href="/karnaval/terms_karnaval.htm"></a></li>
    <li class="sm7"><a href="/karnaval/terms_karnaval.htm"></a></li>
  </ul>
 </div>
 <div id="zv_place" style="position:absolute; right:300px;"></div>

 
 
</div>

 
<!--<div class="obyava" id="obyava">&emsp;&emsp;&nbsp;&emsp;&emsp;&nbsp;&emsp;&emsp;&nbsp;&emsp;&emsp;ВНИМАНИЕ! с 4 июля изменился счет для оплаты продления<br />&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;см. раздел ПРОДЛЕНИЕ на нашем сайте</a></div>-->

  
